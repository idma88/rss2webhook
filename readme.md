# RSS2Webhook

## Описание
Проверяет наличие обновлений в RSS-канале и отправляет WebHook при изменениях

## Настройка
RSS-каналы, Webhook'и и шаблоны задаются в файле `config/feeds.json`

```json
[
    {
        "url": "...",
        "avatarUrl": "...",
        "username": "...",
        "template": {
            "content": "...",
            "embeds": [
                {
                    "title": "...",
                    "url": "...",
                    "image": "..."
                }
            ]
        },
        "destinations": [
            {
                "guildId": "...",
                "channelId": "..."
            }
        ]
    },
    ...
]
```

### Базовые настройки
| Поле           | Описание                             | Обязательный |
|----------------|--------------------------------------|--------------|
| `url`          | Адрес ленты новостей                 | ✅            |
| `avatarUrl`    | URL аватара для ленты (JPEG/PNG/GIF) |              |
| `username`     | Отображаемое имя пользователя        |              |
| `template`     | Шаблон сообщения                     | ✅            |
| `destinations` | Массив точек назначений              | ✅            |

### Шаблон
| Поле      | Описание                       | Обязательный |
|-----------|--------------------------------|--------------|
| `content` | Текст сообщения                | ✅            |
| `embeds`  | Массив Rich Embeds (до 10 шт.) |              |

### Rich Embed
| Поле          | Описание            | Обязательный |
|---------------|---------------------|--------------|
| `author`      | Автор               |              |
| `color`       | Цвет боковой плашки |              |
| `description` | Описание            |              |
| `footer`      | Текст в подвале     |              |
| `image`       | URL изображения     |              |
| `thumbnail`   | URL миниатюры       |              |
| `timestamp`   | Отметка времени     |              |
| `title`       | Текст в заголовоке  |              |
| `url`         | URL                 |              |

### Точки назначения
| Поле        | Описание   | Обязательный |
|-------------|------------|--------------|
| `guildId`   | ID сервера | ✅            |
| `channelId` | ID канала  | ✅            |

Для полей `template.content` и `template.embeds.*` доступны следующие заполнители:
| Заполнитель          | Описание        |
|----------------------|-----------------|
| `{{EntryTitle}}`     | Заголовок       |
| `{{EntryUrl}}`       | URL             |
| `{{EntryAuthor}}`    | Автор           |
| `{{EntryContent}}`   | Содержимое      |
| `{{EntryPublished}}` | Дата публикации |
| `{{EntryImageUrl}}`  | URL изображения |

> URL изображения (заполнитель `{{EntryImageUrl}}`) извлекается из поля `<enclosure><url>`.
> Если поле отсутствует, то производится попытка извлечения URL из содержимого (производится поиск первого HTML-тега IMG)

## Конфигурация
Параметры конфигурации могут быть заданы через переменные окружения или в файле `.env`

| Параметр             | Описание              | Значение по-умолчанию | Обязательный |
|----------------------|-----------------------|-----------------------|--------------|
| `DISCORD_TOKEN`      | Токен Discord бота    | -                     | ✅            |
| `RSS_UPDATE_TIMEOUT` | Период проверки в мс. | 60000                 |              |
